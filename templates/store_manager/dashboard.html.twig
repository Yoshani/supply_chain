{% extends 'base.html.twig' %}

{% block title %}Placed Orders{% endblock %}
{% block stylesheets %}
    {{ parent()  }}
    <link rel="stylesheet" type="text/css" href="../css/side_bar.css">
{% endblock %}
{% block body %}
    <div id="sidebar">
        <div class="toggle-btn" onclick="toggleSidebar()">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <ul>
            <li>Home</li>
            <li>Product +</li>
            <li>Reports</li>
        </ul>
    </div>

        <h1>Expected Train Deliveries</h1>

        <table class="table">
            <thead>
            <tr>
                <th>Train ID</th>
                <th>Date</th>
                <th>Start Time</th>
                <th>Expected Arrival</th>
                <th>Number of Orders</th>
                <th></th>

            </tr>
            </thead>
            <tbody>

            {% for train in trains %}
                <tr>
                    <td >{{ train['id'] }}</td>
                    <td>{{ train['date'] }}</td>
                    <td>{{ train['start_time'] }}</td>
                    <td>{{ train['expected_arrival']}}</td>
                    <td>{{ train['order_count'] }}</td>
                    <td>
                        <button class="btn btn-sm btn-danger arrived" data-id="{{train['id'] }}">Arrived</button>
                    </td>
                </tr>

            {% else %}
                <tr>
                    <td colspan="5">no expected trains</td>
                </tr>
            {% endfor %}

            </tbody>
        </table>
        <br>
        <h1>Orders in Store</h1>

        {% if (orders|length > 0) %}
            <ul class="nav nav-tabs" role="tablist" id="myTab2">
                {% for route, order in orders %}
                    <li class="nav-item">
                        {% if (loop.index)==1 %}
                            <a class="nav-link active" href="{{ '#'~route }}" id="{{ route~'-tab' }}" role="tab" data-toggle="tab" aria-controls="{{ route }}" aria-selected="true">{{ "Route #"~route }}</a>
                        {% else %}
                            <a class="nav-link" href="{{ '#'~route }}" id= "{{ route~'-tab' }}" role="tab" data-toggle="tab" aria-controls="{{ route }}" aria-selected="false">{{ "Route #"~route }}</a>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
            <div class="tab-content" id="myTabContent2">
                {% for route, order in orders %}
                    {% if (loop.index)==1 %}
                        <div class="tab-pane show fade active" role="tabpanel" id= "{{ route }}" aria-labelledby="{{ route~'-tab' }}">
                    {% else %}
                        <div class="tab-pane fade" role="tabpanel" id= "{{ route }}" aria-labelledby="{{ route~'-tab' }}">
                    {% endif %}

                    <table class="table">
                        <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Products</th>
                          
                        </tr>
                        </thead>
                        <tbody>

                        {% for key in order|keys %}
                            <tr>
                                <td class="order_id">{{ key }}</td>
                                <td>{{ order[key]['first_name']~" "~ order[key]['last_name'] }}</td>
                                <ul>
                                    <td>
                                        {% for product in order[key]['products'] %}
                                            <li>{{product.name~" - "~product.quantity }} </li>
                                        {% endfor %}
                                    </td>
                                </ul>                            
                            </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
                {% endfor %}
            </div>    
            
            {% else %}
            <p class="lead">No Data available</p>
             {% endif %} 


{% endblock %}

{% block javascripts %}
    {{ parent()  }}
    <script src="../js/store_manager.js"></script>
    <script src="../js/side_bar.js"></script>
{% endblock %}



